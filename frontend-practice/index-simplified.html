<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplified Test - Frontend Practice</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <header class="header">
        <h1 class="header__title">design playground</h1>
        <p class="header__subtitle">simplified test</p>
    </header>

    <main class="main">
        <section class="card">
            <h2 class="card__title">3D Animation with Three.js</h2>
            <p class="card__content">
                Simplified test of the 3D thunderbolt animation.
            </p>
            <div class="threejs-container" id="threejs-container">
                <span class="sr-only">3D animation container</span>
            </div>
            <div class="threejs-controls">
                <button class="button button--primary" id="toggle-animation">Pause Animation</button>
                <button class="button button--primary" id="change-color">Change Color</button>
            </div>
        </section>
        
        <section class="card">
            <h2 class="card__title">3D Room Scene</h2>
            <p class="card__content">
                Simplified test of the 3D room scene.
            </p>
            <div class="threejs-container" id="room-container">
                <!-- Room Three.js canvas will be inserted here -->
            </div>
            <div class="threejs-controls">
                <button class="button button--primary" id="zoom-in-room">Zoom In</button>
                <button class="button button--primary" id="zoom-out-room">Zoom Out</button>
                <button class="button button--primary" id="toggle-room-lighting">Toggle Lighting</button>
                <button class="button button--primary" id="reset-room-camera">Reset View</button>
            </div>
        </section>
    </main>

    <!-- Three.js with single CDN (the one that worked) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
    
    <!-- Simplified JavaScript -->
    <script>
        console.log('üöÄ Simplified test starting...');
        
        // Wait for DOM and Three.js
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM loaded');
            
            function waitForThreeJS() {
                if (typeof THREE === 'undefined') {
                    console.log('‚è≥ Waiting for Three.js...');
                    setTimeout(waitForThreeJS, 100);
                    return;
                }
                
                console.log(`‚úÖ Three.js r${THREE.REVISION} loaded`);
                initializeAnimations();
            }
            
            waitForThreeJS();
        });
        
        function initializeAnimations() {
            console.log('üé¨ Initializing animations...');
            
            try {
                initSimpleThunderbol();
                initSimpleRoom();
                console.log('‚úÖ Animations initialized successfully');
            } catch (error) {
                console.error('‚ùå Animation initialization failed:', error);
            }
        }
        
        function initSimpleThunderbol() {
            console.log('‚ö° Creating thunderbolt animation...');
            
            const container = document.getElementById('threejs-container');
            if (!container) {
                throw new Error('Thunderbolt container not found');
            }
            
            // Scene setup
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87ceeb);
            
            // Camera setup
            const camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
            camera.position.z = 5;
            
            // Renderer setup
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild(renderer.domElement);
            
            // Create a simple thunderbolt (box for now)
            const geometry = new THREE.BoxGeometry(0.5, 3, 0.3);
            const material = new THREE.MeshPhongMaterial({ color: 0xffe66d });
            const thunderbolt = new THREE.Mesh(geometry, material);
            scene.add(thunderbolt);
            
            // Add lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);
            
            // Animation loop
            let isAnimating = true;
            function animate() {
                requestAnimationFrame(animate);
                
                if (isAnimating) {
                    thunderbolt.rotation.x += 0.01;
                    thunderbolt.rotation.y += 0.01;
                    thunderbolt.position.y = Math.sin(Date.now() * 0.001) * 0.2;
                }
                
                renderer.render(scene, camera);
            }
            
            animate();
            console.log('‚ö° Thunderbolt animation started');
            
            // Setup controls
            const toggleBtn = document.getElementById('toggle-animation');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    isAnimating = !isAnimating;
                    toggleBtn.textContent = isAnimating ? 'Pause Animation' : 'Start Animation';
                    console.log(`Animation ${isAnimating ? 'started' : 'paused'}`);
                });
            }
            
            const colorBtn = document.getElementById('change-color');
            if (colorBtn) {
                const colors = [0xffe66d, 0xff6b6b, 0x4ecdc4, 0x45b7d1, 0xf9ca24];
                let colorIndex = 0;
                colorBtn.addEventListener('click', () => {
                    colorIndex = (colorIndex + 1) % colors.length;
                    material.color.setHex(colors[colorIndex]);
                    console.log(`Color changed to: ${colors[colorIndex].toString(16)}`);
                });
            }
        }
        
        function initSimpleRoom() {
            console.log('üè¢ Creating room animation...');
            
            const container = document.getElementById('room-container');
            if (!container) {
                throw new Error('Room container not found');
            }
            
            // Scene setup
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0);
            
            // Camera setup
            const camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
            camera.position.set(0, 5, 10);
            
            // Renderer setup
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild(renderer.domElement);
            
            // Create a simple room (box)
            const roomGeometry = new THREE.BoxGeometry(10, 6, 10);
            const roomMaterial = new THREE.MeshPhongMaterial({ color: 0xcccccc, side: THREE.BackSide });
            const room = new THREE.Mesh(roomGeometry, roomMaterial);
            scene.add(room);
            
            // Add some furniture (cubes)
            const furniture = [];
            for (let i = 0; i < 3; i++) {
                const furnitureGeometry = new THREE.BoxGeometry(1, 1, 1);
                const furnitureMaterial = new THREE.MeshPhongMaterial({ color: Math.random() * 0xffffff });
                const furnitureItem = new THREE.Mesh(furnitureGeometry, furnitureMaterial);
                furnitureItem.position.set((i - 1) * 3, -2, 0);
                scene.add(furnitureItem);
                furniture.push(furnitureItem);
            }
            
            // Add lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate furniture
                furniture.forEach((item, index) => {
                    item.rotation.y += 0.005 * (index + 1);
                });
                
                renderer.render(scene, camera);
            }
            
            animate();
            console.log('üè¢ Room animation started');
            
            // Setup simple controls
            const zoomInBtn = document.getElementById('zoom-in-room');
            const zoomOutBtn = document.getElementById('zoom-out-room');
            
            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                    camera.position.multiplyScalar(0.9);
                    console.log('Zoomed in');
                });
            }
            
            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                    camera.position.multiplyScalar(1.1);
                    console.log('Zoomed out');
                });
            }
        }
    </script>
</body>
</html>